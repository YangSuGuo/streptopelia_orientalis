~~~sqlite

-- 场景1：上班打卡（出门-上班-下班-到家）
-- 1.1 创建分类
INSERT INTO categories (name, description, color, icon, sort_order) VALUES 
('上班打卡', '记录上下班打卡信息', '#FF6B6B', 'work', 1);

-- 1.2 创建记录类型（上班打卡）
INSERT INTO record_types (
    name, category_id, description, require_location, has_timer, has_subtasks, 
    has_numeric_values, selection_options, require_photo, max_photos
) VALUES (
    '上班打卡', 1, '记录上下班打卡流程', 1, 1, 1, 0, 
    '{"steps": ["出门", "上班", "下班", "到家"], "subtasks": ["打卡", "拍照"]}', 1, 4
);

-- 1.3 创建分步配置
INSERT INTO record_step_configs (record_type_id, step_name, step_description, step_order, required, allow_skip) VALUES 
(1, '出门', '离开家', 1, 1, 0),
(1, '上班', '到达公司', 2, 1, 0),
(1, '下班', '离开公司', 3, 1, 0),
(1, '到家', '回到家里', 4, 1, 0);

-- 1.4 创建记录
INSERT INTO records (
    record_type_id, title, start_time, end_time, duration_seconds, 
    location_name, latitude, longitude, status
) VALUES (
    1, '2026年1月8日上班', 
    '2026-01-08 08:00:00', '2026-01-08 18:30:00', 37800,
    '公司办公室', 39.9042, 116.4074, 'completed'
);

-- 1.5 创建分步记录
INSERT INTO record_steps (record_id, step_name, step_order, step_status, completed_at) VALUES 
(1, '出门', 1, 'completed', '2026-01-08 08:00:00'),
(1, '上班', 2, 'completed', '2026-01-08 08:30:00'),
(1, '下班', 3, 'completed', '2026-01-08 18:00:00'),
(1, '到家', 4, 'completed', '2026-01-08 18:30:00');

-- 1.6 创建照片记录
INSERT INTO record_photos (record_id, photo_path, description, sort_order) VALUES 
(1, '/storage/photos/checkin_20260108_0830.jpg', '上班打卡照片', 1),
(1, '/storage/photos/checkout_20260108_1800.jpg', '下班打卡照片', 2);

-- 1.7 创建位置记录
INSERT INTO record_locations (record_id, latitude, longitude, address, location_name, accuracy) VALUES 
(1, 39.9042, 116.4074, '北京市朝阳区某某大厦', '公司办公室', 10.0),
(1, 39.9152, 116.4044, '北京市朝阳区某某小区', '家', 10.0);

-- 场景2：工作拍照留影（会议拍照）
-- 2.1 创建记录类型（会议拍照）
INSERT INTO record_types (
    name, category_id, description, require_photo, max_photos, has_notes
) VALUES (
    '会议拍照', 1, '会议相关拍照记录', 1, 10, 1
);

-- 2.2 创建照片配置
INSERT INTO photo_config (record_type_id, max_photos, require_photo, photo_quality, allow_multiple, enable_thumbnail) VALUES 
(2, 10, 1, 'high', 1, 1);

-- 2.3 创建记录
INSERT INTO records (
    record_type_id, title, content, start_time, status
) VALUES (
    2, '周例会拍照', '2026年1月8日周例会', '2026-01-08 10:00:00', 'completed'
);

-- 2.4 创建照片记录
INSERT INTO record_photos (record_id, photo_path, description, width, height, file_size, sort_order) VALUES 
(2, '/storage/photos/meeting_1.jpg', '会议开始', 1920, 1080, 2048000, 1),
(2, '/storage/photos/meeting_2.jpg', '会议讨论', 1920, 1080, 2150000, 2),
(2, '/storage/photos/meeting_3.jpg', '会议结束', 1920, 1080, 1980000, 3);

-- 场景3：个人收入支出记录（午餐支出）
-- 3.1 创建分类
INSERT INTO categories (name, description, color, icon, sort_order) VALUES 
('收支记录', '个人收入支出记录', '#45B7D1', 'money', 3);

-- 3.2 创建记录类型（支出记录）
INSERT INTO record_types (
    name, category_id, description, has_numeric_values, has_text_values,
    selection_options, require_photo, max_photos
) VALUES (
    '支出记录', 2, '个人支出记录', 1, 1, 
    '{"expense_types": ["餐饮", "交通", "购物", "娱乐", "其他"]}', 1, 5
);

-- 3.3 创建数值配置
INSERT INTO record_value_configs (record_type_id, field_name, field_label, field_type, unit, is_required) VALUES 
(3, 'amount', '金额', 'numeric', '元', 1),
(3, 'category', '类别', 'selection', '', 1);

-- 3.4 创建标签配置
INSERT INTO tag_config (record_type_id, tag_name, tag_color, is_preset) VALUES 
(3, '餐饮', '#FF6B6B', 1),
(3, '交通', '#4ECDC4', 1),
(3, '购物', '#45B7D1', 1);

-- 3.5 创建记录
INSERT INTO records (
    record_type_id, title, content, start_time, status, tags_json
) VALUES (
    3, '午餐支出', '在公司附近吃午餐', '2026-01-08 12:30:00', 'completed', '["餐饮", "公司午餐"]'
);

-- 3.6 创建数值记录
INSERT INTO record_values (record_id, field_name, field_value, field_text_value, field_type, unit) VALUES 
(3, 'amount', 35.0, NULL, 'numeric', '元'),
(3, 'category', NULL, '餐饮', 'text', NULL);

-- 3.7 创建照片记录（小票）
INSERT INTO record_photos (record_id, photo_path, description) VALUES 
(3, '/storage/photos/receipt_20260108_1230.jpg', '午餐小票');

-- 场景4：隐私生活记录（洗澡记录）
-- 4.1 创建分类
INSERT INTO categories (name, description, color, icon, sort_order) VALUES 
('隐私记录', '个人隐私生活记录', '#96CEB4', 'private', 4);

-- 4.2 创建记录类型（洗澡记录）
INSERT INTO record_types (
    name, category_id, description, has_timer, timer_duration, 
    has_notes, show_duration, show_start_time, show_end_time
) VALUES (
    '洗澡记录', 3, '个人洗澡记录', 1, 0, 1, 1, 1, 1
);

-- 4.3 创建记录
INSERT INTO records (
    record_type_id, title, content, start_time, end_time, duration_seconds, status
) VALUES (
    4, '洗澡', '晚上洗澡', '2026-01-08 21:00:00', '2026-01-08 21:20:00', 1200, 'completed'
);

-- 场景5：生产批次记录（产品批次）
-- 5.1 创建分类
INSERT INTO categories (name, description, color, icon, sort_order) VALUES 
('生产记录', '生产相关记录', '#FFEAA7', 'production', 5);

-- 5.2 创建记录类型（产品批次记录）
INSERT INTO record_types (
    name, category_id, description, has_text_values, has_numeric_values,
    selection_options, has_subtasks
) VALUES (
    '产品批次记录', 4, '产品批次相关信息', 1, 1, 
    '{"product_types": ["A型", "B型", "C型"]}', 1
);

-- 5.3 创建分步配置
INSERT INTO record_step_configs (record_type_id, step_name, step_description, step_order, required) VALUES 
(5, '原材料检验', '原材料质量检验', 1, 1),
(5, '生产加工', '产品生产加工', 2, 1),
(5, '质量检测', '产品质量检测', 3, 1),
(5, '包装入库', '产品包装入库', 4, 1);

-- 5.4 创建数值配置
INSERT INTO record_value_configs (record_type_id, field_name, field_label, field_type, unit) VALUES 
(5, 'batch_number', '批次号', 'text', ''),
(5, 'quantity', '数量', 'numeric', '件'),
(5, 'weight', '重量', 'numeric', 'kg');

-- 5.5 创建记录
INSERT INTO records (
    record_type_id, title, content, start_time, status
) VALUES (
    5, 'A型产品批次001', 'A型产品第001批次', '2026-01-08 09:00:00', 'in_progress'
);

-- 5.6 创建数值记录
INSERT INTO record_values (record_id, field_name, field_value, field_text_value, field_type, unit) VALUES 
(4, 'batch_number', NULL, 'A001', 'text', ''),
(4, 'quantity', 1000.0, NULL, 'numeric', '件'),
(4, 'weight', 500.0, NULL, 'numeric', 'kg');

-- 场景6：工资收入记录（工资截图）
-- 6.1 创建记录类型（工资记录）
INSERT INTO record_types (
    name, category_id, description, has_numeric_values, require_photo, max_photos,
    has_attachments, has_notes
) VALUES (
    '工资记录', 2, '工资收入记录', 1, 1, 1, 1, 1
);

-- 6.2 创建数值配置
INSERT INTO record_value_configs (record_type_id, field_name, field_label, field_type, unit) VALUES 
(6, 'salary_amount', '工资金额', 'numeric', '元'),
(6, 'bonus_amount', '奖金金额', 'numeric', '元');

-- 6.3 创建记录
INSERT INTO records (
    record_type_id, title, content, start_time, status
) VALUES (
    6, '2026年1月工资', '2026年1月工资发放', '2026-01-31 00:00:00', 'completed'
);

-- 6.4 创建数值记录
INSERT INTO record_values (record_id, field_name, field_value, field_type, unit) VALUES 
(5, 'salary_amount', 8000.0, 'numeric', '元'),
(5, 'bonus_amount', 2000.0, 'numeric', '元');

-- 6.5 创建照片记录（工资截图）
INSERT INTO record_photos (record_id, photo_path, description) VALUES 
(5, '/storage/photos/salary_202601.png', '工资发放截图');

-- 查询示例：获取上班打卡记录详情
SELECT 
    r.id as record_id,
    r.title,
    r.start_time,
    r.end_time,
    r.duration_seconds,
    rt.name as record_type_name,
    c.name as category_name,
    COUNT(rs.id) as step_count,
    COUNT(rp.id) as photo_count,
    COUNT(rl.id) as location_count
FROM records r
JOIN record_types rt ON r.record_type_id = rt.id
JOIN categories c ON rt.category_id = c.id
LEFT JOIN record_steps rs ON r.id = rs.record_id
LEFT JOIN record_photos rp ON r.id = rp.record_id
LEFT JOIN record_locations rl ON r.id = rl.record_id
WHERE c.name = '上班打卡'
GROUP BY r.id
ORDER BY r.start_time DESC;

-- 查询示例：获取支出记录统计
SELECT 
    rv.field_text_value as expense_category,
    SUM(rv.field_value) as total_amount,
    COUNT(r.id) as record_count
FROM records r
JOIN record_types rt ON r.record_type_id = rt.id
JOIN record_values rv ON r.id = rv.record_id
WHERE rt.name = '支出记录' AND rv.field_name = 'amount'
GROUP BY rv.field_text_value
ORDER BY total_amount DESC;

-- 查询示例：获取本周记录统计
SELECT 
    c.name as category_name,
    COUNT(r.id) as record_count,
    AVG(r.duration_seconds) as avg_duration
FROM records r
JOIN record_types rt ON r.record_type_id = rt.id
JOIN categories c ON rt.category_id = c.id
WHERE r.start_time >= date('now', '-7 days')
GROUP BY c.id
ORDER BY c.sort_order;

~~~